<html>
  <head>
    <title>cube &raquo; Map Config and Scripting</title>
    <link rel="stylesheet" href="static/style.css" type="text/css" />
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  </head>
  <body>
    <div class="wiki" id="content_view" style="display: block;">
<h1 id="toc0">Overriding default_map_settings.cfg</h1>

<ol>
    <li><a class="wiki_link" href="Map%20Config%20and%20Scripting.html#basic">basic</a> :basic uses, like skymap, fog</li>
    <li><a class="wiki_link" href="Map%20Config%20and%20Scripting.html#cross-platform">cross-platform</a> :what can go wrong when sharing my stuff</li>
    <li><a class="wiki_link" href="Map%20Config%20and%20Scripting.html#textures">textures</a> :loading a texture set</li>
    <li><a class="wiki_link" href="Map%20Config%20and%20Scripting.html#sound">sound</a> :defining sounds and music</li>
    <li><a class="wiki_link" href="Map%20Config%20and%20Scripting.html#triggers">triggers</a> :defining triggers</li>
</ol>

<br />
<br />
<h2 id="toc1">Introduction</h2>
Once you've created a *.cfg file for your map:<br />

<ul>
    <li>Start Sauerbraten</li>
    <li>go to edit mode by pressing the E key one time</li>
    <li>and at the console, type :</li>
</ul>


<pre><code>newmap</code></pre>


<ul>
    <li>Before editing anything, type:</li>
</ul>


<pre><code>savemap mapnamehere</code></pre>


<ul>
    <li>Be sure that the name you save your map as, is the same name as your map.cfg file you created earlier.</li>
    <li>Finally, to put those new textures to work, at the console, type:</li>
</ul>


<pre><code>map mapnamehere</code></pre>


<ul>
    <li>This will reload your map, and load your configuration file as well.</li>
</ul>

<br />
When you want to share your maps with own cfg with others you should package the content and distribute this package to everybody.<br />
Then they should simply need to extract to their own sauerbraten folder, find everything in place (nothing overwritten) and ready to go. Then just meet on any server and load the map, it will look fine.<br />
If you use the coop-edit mode to transfer a map, then only the geometry is passed and the map name will be unknown to you - so no way any but default_map_settings.cfg will be loaded ;)<br />
So either get some free webspace to put your maps on, email them to your friends or get an account on <a class="wiki_link_ext" href="http://www.quadropolis.us" rel="nofollow">quadropolis</a>.<br />
<br />
<br />
<a name="basic"></a><br />
<h2 id="toc2">Basic Uses</h2>
<br />
Each map will first load default_map_settings.cfg<br />
and then any package CFG and last the specific map CFG.<br />
So a map called metl4.ogz will call metl4.cfg.<br />
<br />
The first need for such a specific map configuration file will most likely arise when you want to have a special skybox background. For this enter<br />

<pre><code>loadsky &quot;skyname&quot;
//loadsky &quot;ik2k/env/iklake&quot;
//loadsky &quot;socksy/mars&quot;</code></pre>

where skyname is the path to the 6 required images for a skybox. Check exisiting map CFGs for which skies are available and how to reference them exactly, currently the comment lines in the above code example should work.<br />
<br />
Second, the fog cut-off distance, and fog colour can be applied. For this enter<br />

<pre><code>fog 2500 // can be set from 1 to 100000 as needed
fogcolour 16777215 // this is the max setting. This is also a hex parameter, 0XRRGGBB.</code></pre>

Third, you might want some ambient lighting. For this enter<br />

<pre><code>ambient 15 // can be set from 1 to 255</code></pre>

Be carefull with the ambient option, as it reduces the texture contrast.<br />
To help converting RGB to HEX values this <a class="wiki_link_ext" href="http://www.kenjikojima.com/java/RGBHexConverter2.html" rel="nofollow">RGB &amp; Hex Converter</a> popped up on the forum.<br />
<br />
<br />
<a name="cross-platform"></a><br />
<h3 id="toc3">Cross-Platform</h3>
Beware that your filenames and cfg files match in all spelling of filenames - <br />
especially lower-/uppercase has often been the reason it didn't run somewhere else -<br />
also some platforms sometimes have issues with media.<br />
Known for jpg and mp3 from linux to windows for example.<br />
jpg might be fixed by saving in a windows app :-/ - no guarantee though;<br />
problem doesn't always arise anyway ;)<br />
For music OGG or MIDI are good formats for cross-platform friendliness,<br />
PNG should be available for most textures - skyboxes will need to JPG though.<br />
<br />
<br />
<a name="textures"></a><br />
<h2 id="toc4">Textures</h2>
<br />
The first thing to understand here is, the default map configuration is already in place. Unless you want to add new textures to your map, you do not need this part of a map.cfg Sauerbraten has a very large texture list by default. For the beginner mappers, this shoudl do fine. For the ones that need to add new textures, do the following -<br />
<br />
To explain the meaning of this parameter(s), the line &quot; texture 0 &quot;dg/trail_in.jpg&quot; &quot; for example. The first number after the word texture, stands for the type of texture it will be used as. There are several different types, but for now we'll just use type 0. the part of the line in &quot;&quot; is telling the engine where the texture is located. You must name this directory yourself. When working with a new texture list, you should never add to an original Sauerbraten directory. Create your new directory withing the packages directory.<br />
<br />
Start your map after creating this part of the maps .cfg file. You do not want to retexture anything.<br />
The first thing to add to the texture list section of a map.cfg file, is :<br />

<pre><code>texturereset</code></pre>

This tells the engine to reset from the default configuration, and use the map.cfg for the texture list.<br />
After you reset the texture list, you need to add your own. The first 2 slots are &quot;reserved&quot; for the engine, and must be in every map.cfg file you use new textures with :<br />

<pre><code>texture 0 &quot;ik2k/ik_sky_day_back.jpg&quot;
texture 0 &quot;golgotha/water2d.jpg&quot;</code></pre>

From this point on, you can add as many textures as you want ( up to around 16000 I believe )<br />
You could also list the same texture more than once, to have rotated versions, by adding a number AFTER the texture name:<br />

<pre><code>texture 0 &quot;dg/trail_in.jpg&quot; 0 // 0 = none, 1 = 90 CW, 2 = 180, 3 = 270 CW, 4 = X-axis flip, 5 = Y-axis flip</code></pre>

<br />
<br />
<a name="sound"></a><br />
<h2 id="toc5">Sound</h2>
use the commands<br />

<pre><code>music package_path/file.ogg | file.mp3</code></pre>

and<br />

<pre><code>snd_index = registersound package_path/file.wav | file.mp3

level_trigger_42 = [
  sound $snd_index
]</code></pre>

to add individual sound fx to your map.<br />
<br />
<br />
<a name="triggers"></a><br />
<h3 id="toc6">Triggers</h3>
Defining trigger actions - for SP maps only - is a vast field.<br />
You can basically define any scripting action inside a trigger alias,<br />
this will be parsed when the player enters the space of the trigger entity.<br />
<br />
Read the section about <a class="wiki_link_ext" href="http://sauerbraten.org/docs/editref.html#entitytypes" rel="nofollow">Entity Types</a> to understand what the tie-up with mapmodels is all about.<br />
<br />
You can start off trying out triggers with simple echo commands,<br />
then start scripting the action you'd like to happen.<br />
<br />
To see how doors work you can look at packages/base/door_demo.cfg - and of course the map too ;)<br />
A simplistic form of a <em>secret's counter</em> - can be found on the <a class="wiki_link_new" href="trigger101.html">Trigger 101</a> page.<br />
<br />
Try finding out how maps do stuff if you want to start using triggers yourself.<br />
Then try &quot;faking&quot; the action by calling your script by hand.<br />
Finally select an index for this action, say 42,<br />
then you'll simply need to place this scripting inside a <br />

<pre><code>level_trigger_42 = [
  // your code here
]</code></pre>

alias and place triggers with tag 42 into the right places.<br />
To modify a placed triggers (default menu only has 0-8) tag :<br />

<pre><code>entproperty 3 +30
entproperty 3 +2
entproperty 3 -1</code></pre>


    </div>
  </body>
</html>