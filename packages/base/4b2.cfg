////////////////////////////////////////////////////////////////////////// 
//
// 4B :: Defense Quarters : by MeatROme
//
////////////////////////////////////////////////////////////////////////// 
loadsky "staffy/staffy" -0.84
texturereset    
setshader stdworld
texture 0 "ik2k/ik_sky_day_back.jpg"
texture 0 "golgotha/water2.jpg"
texture 0 "aard/aardograss_1.jpg"
autograss "textures/grass_aard.png"
texture 0 "ik2k/ik_floor_brick128a.jpg" 
texture 0 "ik2k/ik_floor_wood128b.jpg"  
texture 0 "ik2k/ik_ground_cobbles128.jpg" 
texture 0 "ik2k/ik_brick_3216d.jpg"
texture 0 "ik2k/ik_brick_6464c.jpg"
exec "packages/dg/package.cfg"
exec "packages/tech1soc/package.cfg"
exec "packages/ik2k/package.cfg"
exec "packages/ikbase/package.cfg"
exec "packages/payne/package.cfg"
exec "packages/than_ind/package.cfg"
exec "packages/jf1/package.cfg"
texture 0 "aard/aardfdry256_1.jpg"   
texture 0 "tech1soc/spring3.jpg"
texture 0 "tech1soc/sqrlig02wb.jpg"
texture 0 "tech1soc/sqrlig03bc.jpg"
texture 0 "tech1soc/zdetlig01bb.jpg"
texture 0 "tech1soc/zdetlig02bb.jpg"
texture 0 "aard/aardmbr16_2.jpg"
texture 0 "tech1soc/zdetlig04bb.jpg"
texture 0 "tech1soc/zdet_trim2a.jpg"
texture 0 "aard/aardmmet32_1.jpg"
texture 0 "tech1soc/zdet_trim5b.jpg"
texture 0 "schwenz/dt_tile_check.01.jpg"
exec "packages/egyptsoc/package.cfg"
exec "packages/rorschach/package.cfg"
exec "packages/subverse/package.cfg"
exec "packages/g_pack/package.cfg"
texture 0 "jf1/jfsquare.jpg"
texture 0 "jf1/jfyellow.jpg"
texture 0 "tech1soc/jp11a.jpg"
texture 0 "tech1soc/flr_tmtl_drk.jpg"
exec packages/lunaran/package.cfg
exec packages/gibbie/package.cfg
exec packages/philipk/package.cfg
exec packages/gor/package.cfg
exec packages/aftas/package.cfg
setshader stdworld

// additional textures
	texture 0 "tech1soc/half_grill_wall03b.jpg" 1
	texture 0 "than_ind/light03.jpg" 1
setshader glowworld
	setpixelparam 0 0.4 0.4 1.2
	texture 0 "tech1soc/032lig12bb.jpg"
	texture g "4b/032lig12bb_glow.jpg"
setshader glowworld
	setvertexparam 0 1 1 1 
	texture 0 "than_ind/light03.jpg" 
	texture g "4b/light03_g.jpg"
	texture 0 "than_ind/light03.jpg" 1
	texture g "4b/light03_g.jpg" 1
setshader stdworld
// copy of default models
mapmodelreset                                           // start counting from 0 again

mmodel "tree1"                            // 0

mmodel "dcp/tree2"                        // 1
mmodel "dcp/tree3"                        // 2
mmodel "dcp/palmtree"                     // 3
mmodel "dcp/thorns"                       // 4
mmodel "dcp/plant1"                       // 5
mmodel "dcp/grass"                        // 6
mmodel "dcp/ivy"                          // 7

mmodel "dcp/barrel"                       // 8
mmodel "dcp/streetlamp"                   // 9
mmodel "dcp/bench"                        // 10
mmodel "dcp/pillar"                       // 11
mmodel "dcp/waterbowl"                    // 12
mmodel "dcp/jumppad2"                     // 13

mmodel "dcp/leafs"                        // 14
mmodel "dcp/valve"                        // 15
mmodel "dcp/palette"                      // 16

mmodel "dcp/vent"                         // 17
mmodel "dcp/mushroom"                     // 18
mmodel "dcp/biotank"                      // 19

mmodel "dcp/groundlamp"                   // 20
mmodel "dcp/console"                      // 21
mmodel "dcp/turret"                       // 22

// for use as triggers:

mmodel "carrot"                           // 23
mmodel "switch1"                          // 24
mmodel "switch2"                          // 25

mmodel "doors/door_01"                    // 26
mmodel "doors/door_02"                    // 27
mmodel "doors/door_03"                    // 28

mmodel "dcp/cask"		                    // 29
mmodel "dcp/cart"		                    // 30
mmodel "dcp/candle"		                    // 31
mmodel "dcp/vase"		                    // 32
mmodel "dcp/sack"		                    // 33
mmodel "dcp/chandelier"	                    // 34
mmodel "dcp/chest"		                    // 35
mmodel "dcp/firebowl"	                    // 36
mmodel "dcp/smplant" 	                    // 37
mmodel "dcp/insect"	 	                    // 38
mmodel "dcp/reed"	 	                    // 39

mmodel "makke/nocamp"		                // 40
mmodel "makke/strahler"	                    // 41

mmodel "tentus/food-drink/goblet"		    // 42
mmodel "tentus/food-drink/apple"			// 43
mmodel "tentus/food-drink/pear"			    // 44
mmodel "tentus/food-drink/appleslice"	    // 45
mmodel "tentus/food-drink/meat"			    // 46
mmodel "tentus/food-drink/bowl"			    // 47
mmodel "tentus/food-drink/pieslice"		    // 48
mmodel "tentus/food-drink/mug"			    // 49
mmodel "tentus/food-drink/winebottle"	    // 50
mmodel "tentus/food-drink/pie"			    // 51

mmodel "tentus/books/flat"				    // 52
mmodel "tentus/books/multi"				    // 53
mmodel "tentus/chains/chain"				// 54
mmodel "tentus/chains/curvechain"		    // 55

mmodel "tentus/barrel"					    // 56
mmodel "tentus/sidebarrel"				    // 57
mmodel "tentus/pot1"						// 58
mmodel "tentus/rope"						// 59
mmodel "tentus/ropelamp"					// 60
mmodel "tentus/ladder"					    // 61

mmodel "tentus/fattree"					    // 62
mmodel "tentus/moneybag"					// 63
mmodel "tentus/woodbench"				    // 64
mmodel "tentus/hammer"					    // 65
mmodel "tentus/anvil"					    // 66
mmodel "tentus/spear"					    // 67
mmodel "tentus/key"						    // 68
mmodel "tentus/redshield"				    // 69
mmodel "tentus/greenshield"				    // 70
mmodel "tentus/bombs"					    // 71

mmodel "objects/window01"	                // 72
mmodel "objects/sign01"	                    // 73
mmodel "objects/lamp01"					    // 74
mmodel "objects/chair01"					// 75
mmodel "objects/bed01"					    // 76
mmodel "vegetation/tree00"				    // 77
mmodel "vegetation/tree01"				    // 78
mmodel "vegetation/bush01"	                // 79
mmodel "vegetation/tree02"	                // 80
mmodel "vegetation/tree04"	                // 81
mmodel "vegetation/tree05"	                // 82
mmodel "vegetation/tree06"	                // 83
mmodel "vegetation/tree07"	                // 84
mmodel "vegetation/tree03"	                // 85
mmodel "objects/window02/window02_1"	    // 86
mmodel "objects/window02/window02_2"	    // 87
mmodel "objects/bench01"	                // 88
mmodel "objects/lantern01"	                // 89
mmodel "objects/lantern02"	                // 90
mmodel "objects/woodchop"	                // 91
mmodel "objects/table01"	                // 92
mmodel "objects/torch"		                // 93
mmodel "objects/torch_cold"	                // 94
mmodel "objects/fire"		                // 95
mmodel "objects/sail01"		                // 96
mmodel "objects/well_base"	                // 97
mmodel "objects/well_roof"	                // 98
mmodel "objects/lamp02"	                    // 99
mmodel "objects/med_chand"	                // 100

// additional sounds
mapsound "kaiser/fx/computer1" 120
// additional models
mmodel 4b/floppy/gold/silver/bronze
// intro_message?
_intro_m = 0
namebuffer = []
flag_switch1 = 0
flag_switch2 = 0
nextmap_4b2 = [4b3]
_spc_4b2 = 0
// triggers
doorkey = [
	if (= $arg1 -1) [ echo This door requires the @arg2 access code. ]
	if (= $arg1 1) [ echo You copy the @arg2 access code to your PDA. ]
]
switchflip = [ 
	(concatword "flag_switch" $arg2) = $arg1
	if (= $arg1 -1) [ echo You just3 deactivated2 @arg3 ]
	if (= $arg1 1) [ echo You just0 activated2 @arg3 ]
]
switchfail = [
	if (= $arg1 1) [ echo; echo "your orders are to 5leave no monsters alive"; echo "and so 5make your way to the next base"]
	if (= $arg1 2) [ echo "you still need to hack the security-code." ]
]
spcfail = [if (= $_spc_4b2 0) [sp "4b2"] [_spc_4b2 = 0]]
message_one = [
	if (= $_intro_m 1) [ if (= $triggerstate 1) [
		_intro_m = 0
		echo "Okay, you've got the security patch disc."
		echo "Now you need to find a terminal to hack ..."
		echo "... best if you keep it quiet before then."
	] ]
]
message_two = [  
	if (= $flag_switch2 1) [ ] [ 
		echo "you still need to hack the security code."
		echo "damn nuisance that the terminal is behind this door, eh?!"
	] 
]
message_3rd = [ 
	if (= $flag_switch1 1) [ 
		echo " " 
		echo "5forgotten1 something?" 
		echo "3kill2 all5 monsters"
		echo " "
	] [
		echo " "
		echo "fNow for freeing access to the 2second basef."
		echo "fMusn't leave 5any monstersf behind though, before we leave."
		echo " " 
	] 
]
message_4th = [ echo "mmmh..." ]
message_5th = [ if (= $flag_switch2 1) [ ] [ echo;echo "you still need to hack the security code.";echo "where could they have a terminal?";echo ] ]
message_6th = [ 
	if (= $arg1 1) [ 
		switchflip $arg1 1 [access to the 0second base2]
		music [4b/era.ogg] [playasong]
		echo " "
		sleep 700 [echo "uh-oh..."]
	] 
]
message_9th = [ echo; echo "you hear2 shuffling noises1 behind those doors..."; echo "they said to 5leave no monsters standing" ]
message_12 = [ echo; sleep 3141 [ echo "Keeping quiet should be easy, ..."; echo "There doesn't seem to be anyone around." ] ]
message_15 = [ 
	if (= $arg1 1) [
		echo " "
		switchflip @arg1 2 [the 0security-patch2]
		echo "1that plus the 2dead guard1, ..."
		echo "... they're bound to notice soon."
		echo " "
	] [ 
		switchfail 2
	]
]
message_27 = [ echo; echo [Ah, a computer terminal!] echo [fNow for using this 2security patch disc]]
message_29 = [ 
	echo
	echo "fYour next target is 2Distractionf. Nomen Est Omen!"
	echo "fWork your way through their 1security complexf and hope you find access to 2Escher-Spacef." ]
level_trigger_1 = [ message_one $triggerstate ]
level_trigger_2 = [ message_two $triggerstate ]
level_trigger_3 = [ message_3rd $triggerstate ]
level_trigger_4 = [ message_4th $triggerstate ]
level_trigger_5 = [ message_5th $triggerstate ]
level_trigger_6 = [ message_6th $triggerstate ]
level_trigger_7 = [ doorkey $triggerstate silver]
level_trigger_8 = [ doorkey $triggerstate gold ]
level_trigger_12 = [ message_12 ]
level_trigger_15 = [ message_15 $triggerstate ]
level_trigger_17 = [ switchfail 1 ]
level_trigger_21 = [ message_9th ]
level_trigger_23 = [_spc_4b2 = 1]
level_trigger_27 = [ message_27 ]
level_trigger_29 = [ message_29 ]
// autorun
// music
mapsongx = -1
mapsongs = "11 14 13 18 19 20 16"
mapsong0 = "Unaware"
mapsong1 = "Misfortune"
mapsong2 = "Execution"
mapsong3 = "99 To Go"
mapsong4 = "Drunken Deathmatch"
mapsong5 = "Cornered"
mapsong6 = "Straight To Hell"
playasong = [ 
	mapsongx = (+ 1 $mapsongx)
	if (= $mapsongx (listlen $mapsongs)) [mapsongx = 0]
	echo "fnow playing	" (concatword (at $mapsongs $mapsongx) [:]) "	5" (getalias (concatword mapsong $mapsongx))
	music (concatword [fanatic/] (at $mapsongs $mapsongx) [.ogg]) playasong
]
sleep 247 [playasong]
// mission objective
sleep 1723 [
	echo
	echo "Your mission:	2Seek & Destroy"
	echo "Your target:	3Ithaqua"
	echo
	echo "fFirst apply the 0security patch discf, then find 0the bronze discf."
	echo "fLeave NO monsters behind!"
]
//sleep 2500 [sleep 641 [spcfail]]

