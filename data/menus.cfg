// standard menu definitions
// don't modify, add personal menus to autoexec.cfg instead

bind ESCAPE [if (cleargui 1) [] [showgui main]]    // it all starts here

newgui demo [
	guititle "images..."
	guilist [
		guiimage "packages/egyptsoc/wood17.jpg"
		guiimage "packages/egyptsoc/lig_064-01b1.jpg"
		guiimage "packages/egyptsoc/s064-05f.jpg"
		guiimage "packages/egyptsoc/lig_128-05b1.jpg"
		guiimage "packages/egyptsoc/128-04d.jpg"
	]
	guititle "tables"
	guilist [
		guilist [
			guitext "a"
			guitext "b"
			guitext "c"
		]
		guibar
		guilist [
			guitext "d"
			guitext "e"
			guitext "f"
		]
		guibar
		guilist [
			guitext "g"
			guitext "h"
			guitext "i"
		]
        guibar
		guilist [
			guitext "j"
			guitext "k"
			guitext "l"
		]
	]
   guibar
	guilist [
		guibar
		guibutton bang
		guibar
	]
	guibar
    guitab "many maps"
     guilist [
        guilist [
            guititle main
            genmapitems $mainmaps
        ]
        guilist [
            guititle more
            genmapitems $moremaps
        ]
        guilist [
            guititle old
            genmapitems $oldmaps
        ]
    ]
]


newgui main [
    guibutton "load map.."       "showgui maps"
    guibutton "singleplayer.."   "showgui singleplayer"
    guibutton "multiplayer.."    "showgui multiplayer"
    guibutton "editing.."        "showgui editing"
    guibutton "options.."        "showgui options"
    guibutton "about.."          "showgui about"
    guibutton "quit"             "quit"                 "red_button"
]

newgui about [
    guitext "Sauerbraten engine"
    guitext "by Wouter van Oortmerssen" 
    guitext "with contributions from Eihrul, Gilt and others"
    guitext "(for a full list of contributors see the readme)"
    guitext "http://sauerbraten.org/" 
]

maprotation = [
    n = (listlen $arg1)
    loop i $n [
        mapname = (at $arg1 $i)
        next = (mod (+ $i 1) $n)
        nextmap = (at $arg1 $next)
        (if (= $numargs 2) [concatword nextmap_ $arg2 $mapname] [concatword nextmap_ $mapname]) = $nextmap
    ]
]
    
genmapitems = [
    n = (listlen $arg1)
    loop i $n [
        mapname = (at $arg1 $i)
        aliasname = (concatword bestscore_ $mapname)
        title = (if (= (getalias $aliasname) 0) [ result $mapname ] [ concatword $mapname " (best score: " (getalias $aliasname) ")" ])
        guibutton $title (concat map $mapname) "map"
    ]
]

mainmaps = "metl4 deathtek fanatic_quake aard3c metl2 ruby curvedm metl3 nmp8_d complex killfactory roughinery oasis shadowed"
moremaps1 = "chronos moonlite darkdeath thetowers kmap5 jungle serpentine drianmp4 katrez_d orion aard3 aard3b"
moremaps2 = "q1dm4 ksauer1 pgdm ogromines nmp7 vootdm2 vootdm3 mechanic nmp10 battleofthenile nod"
oldmaps1 = "chthon nmp4 tartech wdcd yesterday boxfactory vootdm1 neon space boo2 out id legoland pindakaas"
oldmaps2 = "nmp5 frozen sss new nmp3 sla1 fortress cdf tshagger1a fanatic01 ladder spiralz secondevermap firstevermap"
capturemaps = "fb_capture urban_c face-capture nmp9 nmp8_c ph-capture"
rpgmaps = "k_rpg1 demomap rpg_01 rpg"

maprotation $mainmaps
maprotation $moremaps1
maprotation $moremaps2
maprotation $oldmaps1
maprotation $oldmaps2
maprotation $capturemaps capture_
maprotation $rpgmaps

alias showmapshot [ guiimage (concatword "packages/base/" (at $guirollovername 0) ".jpg") $guirolloveraction 4 ]

newgui maps [
    guilist [
      guilist [ genmapitems $mainmaps ]
      showmapshot
    ]
    guitab more
    guilist [
      guilist [ genmapitems $moremaps1 ]
      guilist [ genmapitems $moremaps2 ]
      showmapshot
    ]
    guitab old
    guilist [
      guilist [ genmapitems $oldmaps1 ]
      guilist [ genmapitems $oldmaps2 ]
      showmapshot
    ]
    guitab capture
    guilist [
      guilist [ genmapitems $capturemaps ]
      showmapshot
    ]
    guitab rpg_test
    guilist [
      guilist [ genmapitems $rpgmaps ]
      showmapshot
    ]
]


spmaps = "vr bbb ogrowaystation frozenbase sp3 sp2 stsp1 door_demo"
ep1maps = "base/sp_maps/sauer_sp1-1 base/sp_maps/sauer_sp1-2 base/sp_maps/sauer_sp1-3 base/sp_maps/sauer_sp1-4 base/sp_maps/sauer_sp1-5 base/sp_maps/sauer_sp1-6 base/base/sp_maps/sauer_sp1-7 base/base/sp_maps/sauer_sp1-8"

maprotation $spmaps
maprotation $ep1maps

newgui spmaps [
    genmapitems $spmaps
]

newgui "Episode1" [
    guibutton "Area 1:" 			"sp base/sp_maps/sauer_sp1-1"
    guibutton "Area 2: Power Station" 		"sp base/sp_maps/sauer_sp1-2"
    guibutton "Area 3: Warehouse" 		"sp base/sp_maps/sauer_sp1-3"
    guibutton "Area 4: Production Facility" 	"sp base/sp_maps/sauer_sp1-4"
    guibutton "Area 5:" "sp base/sp_maps/sauer_sp1-5"
    guibutton "Area 6:" "sp base/sp_maps/sauer_sp1-6"
    guibutton "Area 7:" "sp base/sp_maps/sauer_sp1-7"
    guibutton "Area 8:" "sp base/sp_maps/sauer_sp1-8"
]

newgui singleplayer [
    guibutton "Start An Army Of One"               "mode -2; showgui armyofone"
    guibutton "Start Sauerbraten Episode 1 (WiP!)" "mode -2; showgui Episode1"
    guibutton "start SP map.."                     "mode -2; showgui spmaps"
    guibutton "start DMSP map.."                   "mode -1; showgui maps"
    guitext "skill (default: 3)"
    guislider skill
]

newgui armyofone [
    guibutton "map mpsp6a"
    guibutton "map mpsp6b"
    guibutton "map mpsp6c"
]

newgui multiplayer [
    guibutton "server browser.."  "showgui servers"
    guibutton "update server list from master server" "updatefrommaster; showgui servers"
    guibutton "vote game mode / map .." "showgui gamemode"
    guibutton "lanconnect"
    guibutton "connect localhost"
    guibutton "disconnect"
    guibutton "team good"
    guibutton "team evil"
]

newgui servers [
    guiservers
]

newgui gamemode [
    guibutton "ffa/default"        "mode 0;  showgui maps"
    guibutton "coop edit"          "mode 1;  showgui maps"
    guibutton "ffa/duel"           "mode 2;  showgui maps"
    guibutton "teamplay"           "mode 3;  showgui maps"
    guibutton "instagib"           "mode 4;  showgui maps"
    guibutton "instagib team"      "mode 5;  showgui maps"
    guibutton "efficiency"         "mode 6;  showgui maps"
    guibutton "efficiency team"    "mode 7;  showgui maps"
    guibutton "insta arena"        "mode 8;  showgui maps"
    guibutton "insta clan arena"   "mode 9;  showgui maps"
    guibutton "tactics arena"      "mode 10; showgui maps"
    guibutton "tactics clan arena" "mode 11; showgui maps"
    guibutton "capture"            "mode 12; showgui capturemaps"
]

newgui editing [
    guibutton "insert entity.."                                  "showgui newent"
    guibutton "lighting.."                                       "showgui lighting"
    guibutton "materials.."                                      "showgui materials"
    guibutton "toggle edit mode	(key E)"                    "edittoggle"
    guibutton "select		drag left mouse   "	    " "
    guibutton "select corners	drag middle mouse "         " "
    guibutton "extend selection	right mouse"                   "editmove"
    guibutton "reorient		right mouse"                   "editmove"
    guibutton "move selection	drag right mouse"                   ""
    guibutton "deselect		(key SPACE)"                "cancelsel"
    guibutton "passthrough	(hold ALT)"                        "passthrough"
    guibutton "copy		(key C)"			    "copy"
    guibutton "paste		(key V)"			    "paste"
    guibutton "flip / mirror cube	(key X)"                    "flip"
    guibutton "undo		(key Z, U)"                 "undo"
    guibutton "redo		(key I)"                    "redo"
    guibutton "map operations.."                                 "showgui mapop"
    guibutton "help: show more editing keys..."                  "showgui editkeys"
]

newgui lighting [
    guibutton "recompute lights (SLOW: 8xAA, model shadows)" "calclight 2"
    guibutton "recompute lights (slow: 8xAA)"                "calclight 1"
    guibutton "recompute lights (default: 4xAA)"             "calclight 0"
    guibutton "recompute lights (quick: 2xAA)"               "calclight -1"
    guibutton "recompute lights (FAST: no AA, no shadows)"   "calclight -2"
    guibutton "patch lighting"                         "patchlight"

    guicheckbox "fullbright" fullbright

    guitext "lightprecision (default: 32)"
    guislider lightprecision

    guitext "lighterror (default: 8)"
    guislider lighterror

    //guibutton "lightlod high (6)" "lightlod 6"
    //guibutton "lightlod low  (2)" "lightlod 2"
    //guibutton "lightlod off  (0)" "lightlod 0"
]

newgui materials [
    guibutton "air"                        "editmat air"
    guibutton "water"                      "editmat water"
    guibutton "clip"                       "editmat clip"
    guibutton "glass"                      "editmat glass"
    guibutton "noclip"                     "editmat noclip"

    guicheckbox "show material volumes"    showmat

    //guibutton "waterlod very high		(3)"  "waterlod 3"
    //guibutton "waterlod high		(2)"          "waterlod 2"
    //guibutton "waterlod default		(1)"  "waterlod 1"
    //guibutton "waterlod low		(0)"          "waterlod 0"

    //guibutton "watersubdiv very fine	(0)"          "watersubdiv 0"
    //guibutton "watersubdiv fine		(1)"  "watersubdiv 1"
    //guibutton "watersubdiv default		(2)"  "watersubdiv 2"
    //guibutton "watersubdiv coarse		(3)"  "watersubdiv 3"

    //guibutton "water waves on"                     "waterwaves 1"
    //guibutton "water waves off"                    "waterwaves 0"
]

newgui mapop [
    guibutton "save temp map"                      "savemap temp"
    guibutton "load temp map"                      "map temp"
    guibutton "newmap 256^3 cubes"                 "newmap 10"
    guibutton "newmap 512^3 cubes"                 "newmap 11"
    guibutton "newmap 1024^3 cubes (recommended)"  "newmap 12"
    guibutton "newmap 2048^3 cubes"                "newmap 13"
    guibutton "newmap 4096^3 cubes"                "newmap 14"
    guibutton "newmap 8192^3 cubes"                "newmap 15"
    guibutton "newmap 16384^3 cubes "              "newmap 16"
    guibutton "increase mapsize (2x)"              "mapenlarge"
    guibutton "set undo megs to 1 "		            "undomegs 1"
    guibutton "set undo megs to 5 (default)"       "undomegs 5"
    guibutton "set undo megs to 10"                "undomegs 10"
    guibutton "optimize geometry"                  "remip"
    guibutton "set map title/author"               "saycommand [/mapmsg ]"
]

clearents	= [ 
   if $editing [
	esel [ strcmp (et) $arg1 ]; 
	echo Deleted (esellen) $arg1 entities; 
	delent
   ] 
]
replaceents	= [
   if $editing [
	type = $arg1
	t  = (et)
	a0 = (ea 0)
	a1 = (ea 1)
	a2 = (ea 2)
	a3 = (ea 3)
	esel [ && (= (ea 0) $a0) (&& (&& (strcmp (et) $t) (= (ea 1) $a1)) (&& (= (ea 2) $a2) (= (ea 3) $a3))) ]
	entedit $type $arg2 $arg3 $arg4 $arg5
	echo Replaced (esellen) entities	
   ]
]
selentedit	= [ "saycommand" ( concatword "/entedit " (et) " " (ea 0) " " (ea 1) " " (ea 2) " " (ea 3)) ] 
selreplaceents	= [ "saycommand" ( concatword "/replaceents " (et) " " (ea 0) " " (ea 1) " " (ea 2) " " (ea 3)) ]  

newgui newent [
    guibutton "drop entities.."              "showgui dropent"
    guibutton "mapmodels.."                  "showgui mapmodels"
    guibutton "light.."                      "resetlight;showgui light"
    guibutton "teleport.."                   "showgui teleport"
    guibutton "monster.."                    "showgui monster"
    guibutton "trigger.."                    "showgui trigger"
    guibutton "delete entity	(BACKSPACE)"                        "delent"
    guibutton "edit entity		(PERIOD)" "selentedit"
    guibutton "replace entities	(COMMA)" "selreplaceents"
    guibutton "select entities in box (KP_ENTER)" "esel insel"
    guibutton "newent playerstart"
    guibutton "newent shells"
    guibutton "newent bullets"
    guibutton "newent rockets"
    guibutton "newent riflerounds"
    guibutton "newent grenades"
    guibutton "newent cartridges"
    guibutton "newent health"
    guibutton "newent healthboost"
    guibutton "newent greenarmour"
    guibutton "newent yellowarmour"
    guibutton "newent quaddamage"
]

newgui dropent [
    guitext "drop entities:"
    guiradio "to the floor"                 entdrop 1
    guiradio "on selection"                 entdrop 2
    guiradio "to the floor at selection"    entdrop 3
    guiradio "at current position"          entdrop 0
    guibar
    guicheckbox "entity snap-to-grid"       entselsnap
    guicheckbox "entity selection"          entselradius 2
]

newgui trigger [
    guibutton [invisible]				[BTmm = -1; showgui trigger2]
    guibutton [a carrot]				[BTmm = 23; showgui trigger2]
    guibutton [switch #1]				[BTmm = 24; showgui trigger2]
    guibutton [switch #2]				[BTmm = 25; showgui trigger2]
    guibutton [door #1]					[BTmm = 26; showgui trigger2]
    guibutton [door #2]					[BTmm = 27; showgui trigger2]
    guibutton [door #3]					[BTmm = 28; showgui trigger2]
]

newgui trigger2 [
    guibutton [animation loop]						[BTtt = 0; showgui trigger3]
    guibutton [trigger once (popback)]				[BTtt = 1; showgui trigger3]
    guibutton [trigger once (popback & rumble)]		[BTtt = 2; showgui trigger3]
    guibutton [trigger once]							[BTtt = 3; showgui trigger3]
    guibutton [trigger once (rumble)]				[BTtt = 4; showgui trigger3]
    guibutton [trigger multiple (popback)]			[BTtt = 5; showgui trigger3]
    guibutton [trigger multiple (popback & rumble)]	[BTtt = 6; showgui trigger3]
    guibutton [trigger multiple]						[BTtt = 7; showgui trigger3]
    guibutton [trigger multiple (rumble)]			[BTtt = 8; showgui trigger3]
    guibutton [door (open once)]						[BTtt = 9; showgui trigger3]
    guibutton [door (auto close)]					[BTtt = 10; showgui trigger3]
    guibutton [door (locked)]						[BTtt = 11; showgui trigger3]
    guibutton [vanishing trigger]					[BTtt = 12; showgui trigger3]
    guibutton [vanishing trigger (rumble)]			[BTtt = 13; showgui trigger3]
    guibutton [End Of Level Trigger]					[BTtt = 29; showgui trigger3]
]

build_trigger = [newent mapmodel $BTmm $BTtt $BTti]

newgui trigger3 [
    loop i 9 [
	    tjt = (concat tag (concatword # $i))
	    tjc = (concat BTti "=" $i ";" "build_trigger")
	    guibutton $tjt $tjc 
    ]
]

resetlight = [
    lightcolour = 0
    lightrgb = "255 255 255"
    lightbright = 1
    lightradius = 128
]

lightcmd = [
    lightr = (at $lightrgb 0)
    lightg = (at $lightrgb 1)
    lightb = (at $lightrgb 2)
    if (= $lightbright 0) [
        if (strcmp $lightrgb "255 255 255") [
            lightr = 192; lightg = 192; lightb = 192
        ] [
            lightr = (div $lightr 2); lightg = (div $lightg 2); lightb = (div $lightb 2)
         ]
    ]
    result (concat newent light $lightradius $lightr $lightg $lightb)
]

newgui light [
    guibutton "sunlight"    "newent light 0 255 200 100"
    guibutton (lightcmd)
    guibar
    guicheckbox "bright"    lightbright
    guitext "color:"
    guiradio "white"        lightcolour 0 [lightrgb = "255 255 255"]
    guiradio "blue"         lightcolour 1 [lightrgb = "192 192 255"]
    guiradio "red"          lightcolour 2 [lightrgb = "255 192 192"]
    guiradio "green"        lightcolour 3 [lightrgb = "192 255 192"]
    guiradio "yellow"       lightcolour 4 [lightrgb = "255 255 192"]
    guiradio "purple"       lightcolour 5 [lightrgb = "255 192 255"]
    guiradio "turquoise"    lightcolour 6 [lightrgb = "192 255 255"]
    guitext "radius:"
    guislider lightradius 0 512
]

newgui teleport [
    guibutton "newent teleport 1"
    guibutton "newent teledest 1"
    guibutton "newent teleport 2"
    guibutton "newent teledest 2"
    guibutton "newent teleport 3"
    guibutton "newent teledest 3"
    guibutton "newent teleport 4"
    guibutton "newent teledest 4"
]

mapmodellist = ["tree1"
"dcp/tree2"
"dcp/tree3"
"dcp/palmtree"
"dcp/thorns"
"dcp/plant1"
"dcp/grass"
"dcp/ivy"
"dcp/barrel"
"dcp/streetlamp"
"dcp/bench"
"dcp/pillar"
"dcp/waterbowl"
"dcp/jumppad2"
"dcp/leafs"
"dcp/valve"
"dcp/palette"
"dcp/vent"
"dcp/mushroom"
"dcp/biotank"
"dcp/groundlamp"
"dcp/console"
"dcp/turret"
"carrot"
"switch1"
"switch2"
"doors/door_01"
"doors/door_02"
"doors/door_03"
"dcp/cask"
"dcp/cart"
"dcp/candle"
"dcp/vase"
"dcp/sack"
"dcp/chandelier"
"dcp/chest"
"dcp/firebowl"
"dcp/smplant"
"dcp/insect"
"dcp/reed"
"makke/nocamp"
"makke/strahler"
"tentus/food-drink/goblet"
"tentus/food-drink/apple"
"tentus/food-drink/pear"
"tentus/food-drink/appleslice"
"tentus/food-drink/meat"
"tentus/food-drink/bowl"
"tentus/food-drink/pieslice"
"tentus/food-drink/mug"
"tentus/food-drink/winebottle"
"tentus/food-drink/pie"
"tentus/books/flat"
"tentus/books/multi"
"tentus/chains/chain"
"tentus/chains/curvechain"
"tentus/barrel"
"tentus/sidebarrel"
"tentus/pot1"
"tentus/rope"
"tentus/ropelamp"
"tentus/ladder"
"tentus/fattree"
"tentus/moneybag"
"tentus/woodbench"
"tentus/hammer"
"tentus/anvil"
"tentus/spear"
"tentus/key"
"tentus/redshield"
"tentus/greenshield"
"tentus/bombs"
"objects/window01"
"objects/sign01"
"objects/lamp01"
"objects/chair01"
"objects/bed01"
"vegetation/tree00"
"vegetation/tree01"
"vegetation/bush01"
"vegetation/tree02"
"vegetation/tree04"
"vegetation/tree05"
"vegetation/tree06"
"vegetation/tree07"
"vegetation/tree03"
"objects/window02/window02_1"
"objects/window02/window02_2"
"objects/bench01"
"objects/lantern01"
"objects/lantern02"
"objects/woodchop"
"objects/table01"
"objects/torch"
"objects/torch_cold"
"objects/fire"
"objects/sail01"
"objects/well_base"
"objects/well_roof"
"objects/lamp02"
"objects/med_chand"]

newgui mapmodels [
    loop i (listlen $mapmodellist) [
        cmd = (concat newent mapmodel $i)
        guibutton (at $mapmodellist $i) $cmd
    ]
]

newgui monster [
    guibutton "ogro / fireball"      "newent monster 0"
    guibutton "rhino / chaingun"      "newent monster 1"
    guibutton "ratamahatta / shotgun"      "newent monster 2"
    guibutton "slith / rifle" "newent monster 3"
    guibutton "bauul / RL"     "newent monster 4"
    guibutton "hellpig / bite"       "newent monster 5"
    guibutton "knight / iceball" "newent monster 6"
    guibutton "goblin / slimeball"   "newent monster 7"
]

newgui editkeys [
    guitext "push/pull selection		scroll wheel only"
    guitext "push the face of a cube	hold F + scroll wheel"
    guitext "change gridsize		hold G + scroll wheel"
    guitext "change textures		hold Y + scroll wheel"
    guitext "rotate cubes 90 degrees	hold R + scroll wheel"
    guitext "push corner with cursor	hold Q + scroll wheel"
    guibutton "heightmap mode		(key H)"                           "getheightmap"
    guitext "push/pull heightmap		scroll wheel only"
    guitext "change heightmap brush	hold B + scroll wheel"
    guicheckbox "toggle outline		(key 7)"        outline
    guicheckbox "toggle wireframe		(key 8)"    wireframe
]

newgui options [
    guibutton "keybindings..."       "showgui keybinds"
    guibutton "fullscreen effect.."  "showgui fullscreeneffect"
    guibutton "performance.."        "showgui performanceoptions"
    guibutton "display.."            "showgui displayoptions"
    guibutton "input.."              "showgui inputoptions"
    guibutton "sound.."              "showgui soundoptions"
]

newgui fullscreeneffect [
    guibutton "(effect OFF)"          "setfullscreenshader"
    guibutton "bloom (subtle: 40)"    "setfullscreenshader bloom 40" 
    guibutton "bloom (bright: 80)"    "setfullscreenshader bloom 80" 
    guibutton "bloom (intense: 120)"  "setfullscreenshader bloom 120" 
    guibutton "sobel"  "setfullscreenshader sobel" 
    guibutton "invert" "setfullscreenshader invert" 
    guibutton "gbr"    "setfullscreenshader gbr" 
    guibutton "bw"     "setfullscreenshader bw"  
]

newgui performanceoptions [
    guitext "shader detail (default: 3)"
    guislider shaderdetail
    guicheckbox "water refraction"  waterrefract
    guicheckbox "water reflection"  waterreflect
]

newgui displayoptions [
    guicheckbox "fullscreen"        fullscreen
    guitext "gamma (default: 100)"
    guislider gamma
    guibutton "320x240"              "screenres 320 240"
    guibutton "640x480"              "screenres 640 480"
    guibutton "800x600"              "screenres 800 600"
    guibutton "1024x768"             "screenres 1024 768"
    guibutton "1152x768"             "screenres 1152 768"
    guibutton "1200x960"             "screenres 1200 960"
    guibutton "1280x1024"            "screenres 1280 1024"
    guibutton "1600x1200"            "screenres 1600 1200"
]

newgui inputoptions [
    guicheckbox "invert mouse"      invmouse
]

newgui soundoptions [
    guitext "sound volume"
    guislider soundvol
    guitext "music volume"
    guislider musicvol
]

actions = [forward backward left right jump attack "universaldelta 1" "universaldelta -1" edittoggle saycommand "weapon 1" "weapon 2" "weapon 3" "weapon 4"]

newgui keybinds [
    guitext "(basic keybinds, for anything more use the 'bind' command)"
    guitext "select action to bind:"
    loop i (listlen $actions) [ action = (at $actions $i); guibutton $action (concat menubind $action) ] 
]

menubind = [ tobind = $arg1; showgui binditto ]
bindit = [ bind $arg1 $tobind ]

keys = "MOUSE1 MOUSE2 MOUSE3 MOUSE4 MOUSE5 SPACE LCTRL RCTRL ALT TAB ESCAPE BACKQUOTE SHIFT BACKSPACE ENTER INSERT DELETE HOME END PAGEUP PAGEDOWN A B C D E F G H I J K L M N O P Q R S T U V W X Y Z 1 2 3 4 5 6 7 8 9 0 F1 F2 F3 F4 F5 F6 F7 F8 F9 F10 F11 F12"

newgui binditto [
    loop i (listlen $keys) [ key = (at $keys $i); guibutton $key (concat bindit $key) ]
]
